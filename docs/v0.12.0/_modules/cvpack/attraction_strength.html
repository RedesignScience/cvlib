<!DOCTYPE html>

<html lang="en" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>cvpack.attraction_strength &#8212; CVPack 0.12.0  documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=80d5e7a1" />
    <link rel="stylesheet" type="text/css" href="../../_static/alabaster.css?v=12dfc556" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css?v=572d9513" />
    <script src="../../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../../_static/doctools.js?v=888ff710"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=ccdb6887"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <h1>Source code for cvpack.attraction_strength</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">.. class:: AttractionStrength</span>
<span class="sd">   :platform: Linux, MacOS, Windows</span>
<span class="sd">   :synopsis: The strength of the attraction between two atom groups</span>

<span class="sd">.. classauthor:: Charlles Abreu &lt;craabreu@gmail.com&gt;</span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">typing</span> <span class="k">as</span> <span class="nn">t</span>

<span class="kn">import</span> <span class="nn">openmm</span>
<span class="kn">from</span> <span class="nn">openmm</span> <span class="kn">import</span> <span class="n">unit</span> <span class="k">as</span> <span class="n">mmunit</span>

<span class="kn">from</span> <span class="nn">.collective_variable</span> <span class="kn">import</span> <span class="n">CollectiveVariable</span>
<span class="kn">from</span> <span class="nn">.units</span> <span class="kn">import</span> <span class="n">Quantity</span><span class="p">,</span> <span class="n">ScalarQuantity</span>
<span class="kn">from</span> <span class="nn">.utils</span> <span class="kn">import</span> <span class="n">evaluate_in_context</span>

<span class="n">ONE_4PI_EPS0</span> <span class="o">=</span> <span class="mf">138.93545764438198</span>


<div class="viewcode-block" id="AttractionStrength">
<a class="viewcode-back" href="../../api/AttractionStrength.html#cvpack.AttractionStrength">[docs]</a>
<span class="k">class</span> <span class="nc">AttractionStrength</span><span class="p">(</span><span class="n">openmm</span><span class="o">.</span><span class="n">CustomNonbondedForce</span><span class="p">,</span> <span class="n">CollectiveVariable</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The strength of the attraction between two atom groups:</span>

<span class="sd">    .. math::</span>

<span class="sd">        S_{\rm attr}({\bf r}) = S_{1,2}({\bf r}) = &amp;-\frac{1}{E_{\rm ref}} \Bigg[</span>
<span class="sd">            \sum_{i \in {\bf g}_1}</span>
<span class="sd">                \sum_{\substack{j \in {\bf g}_2 \\ j \neq i}}</span>
<span class="sd">                    \epsilon_{ij} u_{\rm disp}\left(</span>
<span class="sd">                        \frac{\|{\bf r}_i - {\bf r}_j\|}{\sigma_{ij}}</span>
<span class="sd">                    \right) \\</span>
<span class="sd">            &amp;+\sum_{i \in {\bf g}_1}</span>
<span class="sd">            \sum_{\substack{j \in {\bf g}_2 \\ q_jq_i &lt; 0}}</span>
<span class="sd">                \frac{q_i q_j}{4 \pi \varepsilon_0 r_{\rm c}} u_{\rm elec}\left(</span>
<span class="sd">                    \frac{\|{\bf r}_i - {\bf r}_j\|}{r_{\rm c}}</span>
<span class="sd">                \right) \Bigg]</span>

<span class="sd">    where :math:`{\bf g}_1` and :math:`{\bf g}_2` are the two atom groups,</span>
<span class="sd">    :math:`r_{\rm c}` is the cutoff distance, :math:`\varepsilon_0` is the</span>
<span class="sd">    permittivity of empty space, :math:`q_i` is the charge of atom :math:`i`, and</span>
<span class="sd">    :math:`E_{\rm ref}` is a reference value (in energy units per mole).</span>
<span class="sd">    The Lennard-Jones parameters are given by the Lorentz-Berthelot mixing rule, i.e.</span>
<span class="sd">    :math:`\epsilon_{ij} = \sqrt{\epsilon_i \epsilon_j}`, and</span>
<span class="sd">    :math:`\sigma_{ij} = (\sigma_i + \sigma_j)/2`.</span>

<span class="sd">    Optionally, one can provide a third atom group :math:`{\bf g}_3` to contrast</span>
<span class="sd">    the attraction strength between :math:`{\bf g}_1` and :math:`{\bf g}_2` with</span>
<span class="sd">    that between :math:`{\bf g}_1` and :math:`{\bf g}_3`. One can also provide</span>
<span class="sd">    a scaling factor :math:`\alpha` to balance the contributions of the two</span>
<span class="sd">    interactions. In this case, the collective variable becomes</span>

<span class="sd">    .. math::</span>

<span class="sd">        S_{\rm attr}({\bf r}) = S_{1,2}({\bf r}) - \alpha S_{1,3}({\bf r})</span>

<span class="sd">    .. note::</span>

<span class="sd">        Groups :math:`{\bf g}_1` and :math:`{\bf g}_2` can overlap or even be the</span>
<span class="sd">        same, in which case the collective variable will measure the strength of</span>
<span class="sd">        the self-attraction of :math:`{\bf g}_1`. On the other hand, the contrast</span>
<span class="sd">        group :math:`{\bf g}_3` cannot overlap with neither :math:`{\bf g}_1` nor</span>
<span class="sd">        :math:`{\bf g}_2`.</span>

<span class="sd">    The function :math:`u_{\rm disp}(x)` is a Lennard-Jones-like reduced potential with</span>
<span class="sd">    a highly softened repulsion part, defined as</span>

<span class="sd">    .. math::</span>

<span class="sd">        u_{\rm disp}(x) = 4\left(\frac{1}{y^2} - \frac{1}{y}\right),</span>
<span class="sd">        \quad \text{where} \quad</span>
<span class="sd">        y = |x^6 - 2| + 2</span>

<span class="sd">    The function :math:`u_{\rm elec}(x)` provides a Coulomb-like decay with</span>
<span class="sd">    reaction-field screening, defined as</span>

<span class="sd">    .. math::</span>

<span class="sd">        u_{\rm elec}(x) = \frac{1}{x} + \frac{x^2 - 3}{2}</span>

<span class="sd">    The screening considers a perfect conductor as the surrounding medium</span>
<span class="sd">    :cite:`Correa_2022`.</span>

<span class="sd">    .. note::</span>

<span class="sd">        Only attractive electrostatic interactions are considered (:math:`q_i q_i &lt; 0`),</span>
<span class="sd">        which gives :math:`S_{\rm attr}({\bf r})` a lower bound of zero. The upper</span>
<span class="sd">        bound will depends on the system details, the chosen groups of atoms, and the</span>
<span class="sd">        adopted reference value.</span>

<span class="sd">    The Lennard-Jones parameters, atomic charges, cutoff distance, boundary conditions,</span>
<span class="sd">    as well as whether to use a switching function and its corresponding switching</span>
<span class="sd">    distance, are taken from :openmm:`NonbondedForce` object.</span>

<span class="sd">    .. note::</span>
<span class="sd">        Any non-exclusion exceptions involving an atom in :math:`{\bf g}_1` and an atom</span>
<span class="sd">        in either :math:`{\bf g}_2` or :math:`{\bf g}_3` are turned into exclusions in</span>
<span class="sd">        this collective variable.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    group1</span>
<span class="sd">        The first atom group.</span>
<span class="sd">    group2</span>
<span class="sd">        The second atom group.</span>
<span class="sd">    nonbondedForce</span>
<span class="sd">        The :class:`openmm.NonbondedForce` object from which to collect the necessary</span>
<span class="sd">        parameters.</span>
<span class="sd">    contrastGroup</span>
<span class="sd">        An optional third atom group to contrast the attraction strength between</span>
<span class="sd">        :math:`{\bf g}_1` and :math:`{\bf g}_2` with that between :math:`{\bf g}_1`</span>
<span class="sd">        and :math:`{\bf g}_3`.</span>
<span class="sd">    reference</span>
<span class="sd">        A reference value (in energy units per mole) to which the collective variable</span>
<span class="sd">        should be normalized. One can also provide an :OpenMM:`Context` object from</span>
<span class="sd">        which to extract a reference attraction strength. The extracted value will be</span>
<span class="sd">        :math:`S_{1,2}({\bf r})` for :math:`E_{\rm ref} = 1`, regardless of whether</span>
<span class="sd">        `contrastGroup` is provided or not.</span>
<span class="sd">    contrastScaling</span>
<span class="sd">        A scaling factor :math:`\alpha` to balance the contributions of the two</span>
<span class="sd">        interactions. The default is 1.0.</span>
<span class="sd">    name</span>
<span class="sd">        The name of the collective variable.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; import cvpack</span>
<span class="sd">    &gt;&gt;&gt; from openmm import unit</span>
<span class="sd">    &gt;&gt;&gt; from openmmtools import testsystems</span>
<span class="sd">    &gt;&gt;&gt; model = testsystems.HostGuestExplicit()</span>
<span class="sd">    &gt;&gt;&gt; guest = [a.index for a in model.topology.atoms() if a.residue.name == &quot;B2&quot;]</span>
<span class="sd">    &gt;&gt;&gt; host = [a.index for a in model.topology.atoms() if a.residue.name == &quot;CUC&quot;]</span>
<span class="sd">    &gt;&gt;&gt; forces = {f.getName(): f for f in model.system.getForces()}</span>
<span class="sd">    &gt;&gt;&gt; cv1 = cvpack.AttractionStrength(guest, host, forces[&quot;NonbondedForce&quot;])</span>
<span class="sd">    &gt;&gt;&gt; cv1.addToSystem(model.system)</span>
<span class="sd">    &gt;&gt;&gt; platform = openmm.Platform.getPlatformByName(&quot;Reference&quot;)</span>
<span class="sd">    &gt;&gt;&gt; integrator = openmm.VerletIntegrator(1.0 * mmunit.femtoseconds)</span>
<span class="sd">    &gt;&gt;&gt; context = openmm.Context(model.system, integrator, platform)</span>
<span class="sd">    &gt;&gt;&gt; context.setPositions(model.positions)</span>
<span class="sd">    &gt;&gt;&gt; cv1.getValue(context)</span>
<span class="sd">    4912.5... dimensionless</span>

<span class="sd">    &gt;&gt;&gt; water = [a.index for a in model.topology.atoms() if a.residue.name == &quot;HOH&quot;]</span>
<span class="sd">    &gt;&gt;&gt; cv2 = cvpack.AttractionStrength(guest, water, forces[&quot;NonbondedForce&quot;])</span>
<span class="sd">    &gt;&gt;&gt; cv2.addToSystem(model.system)</span>
<span class="sd">    &gt;&gt;&gt; context.reinitialize(preserveState=True)</span>
<span class="sd">    &gt;&gt;&gt; cv2.getValue(context)</span>
<span class="sd">    2063.3... dimensionless</span>

<span class="sd">    &gt;&gt;&gt; cv3 = cvpack.AttractionStrength(guest, host, forces[&quot;NonbondedForce&quot;], water)</span>
<span class="sd">    &gt;&gt;&gt; cv3.addToSystem(model.system)</span>
<span class="sd">    &gt;&gt;&gt; context.reinitialize(preserveState=True)</span>
<span class="sd">    &gt;&gt;&gt; cv3.getValue(context)</span>
<span class="sd">    2849.17... dimensionless</span>
<span class="sd">    &gt;&gt;&gt; print(cv1.getValue(context) - cv2.getValue(context))</span>
<span class="sd">    2849.17... dimensionless</span>

<span class="sd">    &gt;&gt;&gt; cv4 = cvpack.AttractionStrength(</span>
<span class="sd">    ...     guest, host, forces[&quot;NonbondedForce&quot;], water, contrastScaling=0.5</span>
<span class="sd">    ... )</span>
<span class="sd">    &gt;&gt;&gt; cv4.addToSystem(model.system)</span>
<span class="sd">    &gt;&gt;&gt; context.reinitialize(preserveState=True)</span>
<span class="sd">    &gt;&gt;&gt; cv4.getValue(context)</span>
<span class="sd">    3880.8... dimensionless</span>
<span class="sd">    &gt;&gt;&gt; 1 * cv1.getValue(context) - 0.5 * cv2.getValue(context)</span>
<span class="sd">    3880.8...</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>  <span class="c1"># pylint: disable=too-many-locals</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">group1</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span>
        <span class="n">group2</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span>
        <span class="n">nonbondedForce</span><span class="p">:</span> <span class="n">openmm</span><span class="o">.</span><span class="n">NonbondedForce</span><span class="p">,</span>
        <span class="n">contrastGroup</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">reference</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">ScalarQuantity</span><span class="p">,</span> <span class="n">openmm</span><span class="o">.</span><span class="n">Context</span><span class="p">]</span> <span class="o">=</span> <span class="n">Quantity</span><span class="p">(</span>
            <span class="mf">1.0</span> <span class="o">*</span> <span class="n">mmunit</span><span class="o">.</span><span class="n">kilojoule_per_mole</span>
        <span class="p">),</span>
        <span class="n">contrastScaling</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;attraction_strength&quot;</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">group1</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">group1</span><span class="p">)</span>
        <span class="n">group2</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">group2</span><span class="p">)</span>
        <span class="n">contrasting</span> <span class="o">=</span> <span class="n">contrastGroup</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">contrasting</span><span class="p">:</span>
            <span class="n">contrastGroup</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">contrastGroup</span><span class="p">)</span>
        <span class="n">cutoff</span> <span class="o">=</span> <span class="n">nonbondedForce</span><span class="o">.</span><span class="n">getCutoffDistance</span><span class="p">()</span><span class="o">.</span><span class="n">value_in_unit</span><span class="p">(</span><span class="n">mmunit</span><span class="o">.</span><span class="n">nanometers</span><span class="p">)</span>
        <span class="n">expression</span> <span class="o">=</span> <span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;-(lj + coul)</span><span class="si">{</span><span class="s1">&#39;*sign1*sign2&#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">contrasting</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="si">}</span><span class="s2">/ref&quot;</span>
            <span class="s2">&quot;; lj = 4*epsilon*(1/y^2 - 1/y)&quot;</span>
            <span class="sa">f</span><span class="s2">&quot;; coul = </span><span class="si">{</span><span class="n">ONE_4PI_EPS0</span><span class="si">}</span><span class="s2">*q1q2*(1/x + (x^2 - 3)/2)&quot;</span>
            <span class="sa">f</span><span class="s2">&quot;; x = r/</span><span class="si">{</span><span class="n">cutoff</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="s2">&quot;; y = abs((r/sigma)^6 - 2) + 2&quot;</span>
            <span class="s2">&quot;; q1q2 = min(0, charge1*charge2)&quot;</span>
            <span class="s2">&quot;; epsilon = sqrt(epsilon1*epsilon2)&quot;</span>
            <span class="s2">&quot;; sigma = (sigma1 + sigma2)/2&quot;</span>
            <span class="s2">&quot;; ref = 1&quot;</span>
        <span class="p">)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">expression</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setNonbondedMethod</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">CutoffPeriodic</span>
            <span class="k">if</span> <span class="n">nonbondedForce</span><span class="o">.</span><span class="n">usesPeriodicBoundaryConditions</span><span class="p">()</span>
            <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">CutoffNonPeriodic</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setCutoffDistance</span><span class="p">(</span><span class="n">cutoff</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">parameter</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;charge&quot;</span><span class="p">,</span> <span class="s2">&quot;sigma&quot;</span><span class="p">,</span> <span class="s2">&quot;epsilon&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="s2">&quot;sign&quot;</span><span class="p">,)</span> <span class="o">*</span> <span class="n">contrasting</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">addPerParticleParameter</span><span class="p">(</span><span class="n">parameter</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nonbondedForce</span><span class="o">.</span><span class="n">getNumParticles</span><span class="p">()):</span>
            <span class="n">charge</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">epsilon</span> <span class="o">=</span> <span class="n">nonbondedForce</span><span class="o">.</span><span class="n">getParticleParameters</span><span class="p">(</span><span class="n">atom</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">contrasting</span><span class="p">:</span>
                <span class="n">sign</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> <span class="k">if</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">contrastGroup</span> <span class="k">else</span> <span class="mi">1</span>
                <span class="n">scale</span> <span class="o">=</span> <span class="n">contrastScaling</span> <span class="k">if</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">contrastGroup</span> <span class="k">else</span> <span class="mi">1</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">addParticle</span><span class="p">([</span><span class="n">charge</span> <span class="o">*</span> <span class="n">scale</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">epsilon</span> <span class="o">*</span> <span class="n">scale</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">sign</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">addParticle</span><span class="p">([</span><span class="n">charge</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">epsilon</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">exception</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nonbondedForce</span><span class="o">.</span><span class="n">getNumExceptions</span><span class="p">()):</span>
            <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="o">*</span><span class="n">_</span> <span class="o">=</span> <span class="n">nonbondedForce</span><span class="o">.</span><span class="n">getExceptionParameters</span><span class="p">(</span><span class="n">exception</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">addExclusion</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setUseSwitchingFunction</span><span class="p">(</span><span class="n">nonbondedForce</span><span class="o">.</span><span class="n">getUseSwitchingFunction</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setSwitchingDistance</span><span class="p">(</span><span class="n">nonbondedForce</span><span class="o">.</span><span class="n">getSwitchingDistance</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setUseLongRangeCorrection</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">addInteractionGroup</span><span class="p">(</span><span class="n">group1</span><span class="p">,</span> <span class="n">group2</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">reference</span><span class="p">,</span> <span class="n">openmm</span><span class="o">.</span><span class="n">Context</span><span class="p">):</span>
            <span class="n">reference</span> <span class="o">=</span> <span class="n">evaluate_in_context</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reference</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">mmunit</span><span class="o">.</span><span class="n">is_quantity</span><span class="p">(</span><span class="n">reference</span><span class="p">):</span>
            <span class="n">reference</span> <span class="o">=</span> <span class="n">reference</span><span class="o">.</span><span class="n">value_in_unit</span><span class="p">(</span><span class="n">mmunit</span><span class="o">.</span><span class="n">kilojoule_per_mole</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setEnergyFunction</span><span class="p">(</span><span class="n">expression</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;ref = 1&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;ref = </span><span class="si">{</span><span class="n">reference</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">contrasting</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">addInteractionGroup</span><span class="p">(</span><span class="n">group1</span><span class="p">,</span> <span class="n">contrastGroup</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_registerCV</span><span class="p">(</span>
            <span class="n">name</span><span class="p">,</span>
            <span class="n">mmunit</span><span class="o">.</span><span class="n">dimensionless</span><span class="p">,</span>
            <span class="n">group1</span><span class="o">=</span><span class="n">group1</span><span class="p">,</span>
            <span class="n">group2</span><span class="o">=</span><span class="n">group2</span><span class="p">,</span>
            <span class="n">nonbondedForce</span><span class="o">=</span><span class="n">nonbondedForce</span><span class="p">,</span>
            <span class="n">contrastGroup</span><span class="o">=</span><span class="n">contrastGroup</span><span class="p">,</span>
            <span class="n">reference</span><span class="o">=</span><span class="n">reference</span><span class="p">,</span>
            <span class="n">contrastScaling</span><span class="o">=</span><span class="n">contrastScaling</span><span class="p">,</span>
        <span class="p">)</span></div>



<span class="n">AttractionStrength</span><span class="o">.</span><span class="n">registerTag</span><span class="p">(</span><span class="s2">&quot;!cvpack.AttractionStrength&quot;</span><span class="p">)</span>
</pre></div>

          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../index.html">CVPack 0.12.0</a></h1>











<h3><a href="../../index.html">Table of Contents</a></h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/index.html">Collective Variables</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reporting.html">Reporting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../serialization.html">Serialization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../references.html">Bibliography</a></li>
</ul>

<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2024 C. Abreu & Redesign Science.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 7.2.6</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 0.7.16</a>
      
    </div>

    

    
  </body>
</html>